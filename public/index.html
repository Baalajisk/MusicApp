<html>
    <head>
        <title>My Music App</title>
    </head>
    <body>
        <h1>Music App</h1>
        <br>
        <br>
        <a href='/room1'>Room1</a>
        <br>
        <br>
        <a href='/room2'>Room2</a>
        <br>
        <br>
        <a href='/audioRoom?newRoom=true'>Create Room</a>
        <br>
        <br>
        <div id='roomsDiv'>
            <h3>Available Rooms</h3>
            <br>
            
        </div>

        <script src="/socket.io/socket.io.js"></script>
        <script>
            var socket = io();
            socket.on('connect',()=>{
                socket.emit('getRooms');
                
            });

            socket.on('availableRooms',(rooms)=>{

                console.log(rooms);


                if(rooms.length>0){
                    for(let i=0;i<rooms.length;i++){
                        let divNode=document.getElementById('roomsDiv');
                        let anchorNode=document.createElement('a');
                        let breakNode=document.createElement("br");
                        
                        let roomId=rooms[i];
                        let innerTextNode= document.createTextNode(`Link to room ${roomId}`);
                        anchorNode.appendChild(innerTextNode);
                        anchorNode.href=`/audioRoom?newRoom=false&roomId=${roomId}`;
                        divNode.appendChild(anchorNode);
                        divNode.appendChild(breakNode);

                    }
                }
              

                
            });

            socket.on('createRoomLink',(roomName)=>{
                console.log(`The room ${roomName} created`);
            })
        </script>
    </body>
</html>